<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PROPIO OS - Plataforma Multi-Producto de Crédito Alternativo</title>
  <meta name="description" content="Sistema operativo para crédito alternativo con FIDES - Financial Identity & Data Enrichment System">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <!-- Babel for JSX -->
  <script src="https://unpkg.com/lucide-react@0.344.0/dist/umd/lucide-react.js"></script>
  <!-- Lucide React Icons -->
  <script src="https://unpkg.com/lucide-react@0.263.1/dist/umd/lucide-react.min.js"></script>
  
  <style>
    * {
      scrollbar-width: thin;
      scrollbar-color: #334155 #0f172a;
    }
    *::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    *::-webkit-scrollbar-track {
      background: #0f172a;
    }
    *::-webkit-scrollbar-thumb {
      background-color: #334155;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState } = React;
    const { 
      Database, Users, Building2, FileText, Shield, Brain, 
      TrendingUp, Bell, MessageSquare, BarChart3, Workflow,
      CheckCircle2, Clock, AlertTriangle, ChevronRight,
      Layers, GitBranch, Zap, Target, Calendar, DollarSign,
      Home, UserCheck, FileCheck, Scale, Send, PieChart,
      Settings, Eye, Lock, RefreshCw, ArrowRight, ArrowDown,
      Activity, Briefcase, CreditCard, Building, Landmark,
      ClipboardList, Timer, TrendingDown, Award, Filter,
      Fingerprint, LineChart, Sparkles, Package, Wallet, Wrench,
      ShieldCheck, Key, Server, BookOpen, UserCog, Globe, Monitor
    } = lucideReact;

    // ============================================
    // PROPIO OS v2.0 - Sistema Operativo Multi-Producto
    // Plataforma de crédito alternativo con FIDES
    // ============================================

    function PropioOSBlueprint() {
      const [activeLayer, setActiveLayer] = useState('overview');
      const [activePhase, setActivePhase] = useState(1);
      const [activeProduct, setActiveProduct] = useState('renttoown');
      const [activeSecurityPhase, setActiveSecurityPhase] = useState(1);

      const layers = [
        { id: 'overview', name: 'Vista General', icon: Eye },
        { id: 'fides', name: 'FIDES', icon: Fingerprint, highlight: true },
        { id: 'products', name: 'Productos', icon: Package },
        { id: 'engines', name: 'Motores', icon: Brain },
        { id: 'data', name: 'Datos', icon: Database },
        { id: 'operations', name: 'Operaciones', icon: Workflow },
        { id: 'security', name: 'Ciberseguridad', icon: ShieldCheck, highlight: true },
        { id: 'roadmap', name: 'Roadmap', icon: Calendar },
      ];

      return (
        <div className="min-h-screen bg-slate-950 text-slate-100 font-mono">
          {/* Header */}
          <header className="border-b border-cyan-500/30 bg-slate-900/80 backdrop-blur-sm sticky top-0 z-50">
            <div className="max-w-[1800px] mx-auto px-6 py-4">
              <div className="flex items-center justify-between">
                <div className="flex items-center gap-4">
                  <div className="w-10 h-10 bg-gradient-to-br from-cyan-400 to-violet-600 rounded-lg flex items-center justify-center">
                    <Layers className="w-6 h-6 text-white" />
                  </div>
                  <div>
                    <h1 className="text-xl font-bold tracking-tight">
                      <span className="text-cyan-400">PROPIO</span>
                      <span className="text-slate-400 ml-2">OS</span>
                    </h1>
                    <p className="text-xs text-slate-500">Plataforma Multi-Producto de Crédito Alternativo</p>
                  </div>
                </div>
                <div className="flex items-center gap-3 text-xs">
                  <span className="px-2 py-1 bg-violet-500/20 text-violet-400 rounded border border-violet-500/30">MULTI-PRODUCTO</span>
                  <span className="px-2 py-1 bg-emerald-500/20 text-emerald-400 rounded">v2.0</span>
                </div>
              </div>
            </div>
          </header>

          {/* Navigation */}
          <nav className="border-b border-slate-800 bg-slate-900/50">
            <div className="max-w-[1800px] mx-auto px-6">
              <div className="flex gap-1 overflow-x-auto py-2">
                {layers.map((layer) => (
                  <button
                    key={layer.id}
                    onClick={() => setActiveLayer(layer.id)}
                    className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm transition-all whitespace-nowrap ${
                      activeLayer === layer.id
                        ? layer.highlight 
                          ? layer.id === 'security'
                            ? 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/40'
                            : 'bg-violet-500/20 text-violet-400 border border-violet-500/40'
                          : 'bg-cyan-500/20 text-cyan-400 border border-cyan-500/40'
                        : 'text-slate-400 hover:text-slate-200 hover:bg-slate-800'
                    }`}
                  >
                    <layer.icon className="w-4 h-4" />
                    {layer.name}
                    {layer.highlight && layer.id === 'fides' && <Sparkles className="w-3 h-3 text-violet-400" />}
                    {layer.highlight && layer.id === 'security' && <ShieldCheck className="w-3 h-3 text-emerald-400" />}
                  </button>
                ))}
              </div>
            </div>
          </nav>

          {/* Main Content */}
          <main className="max-w-[1800px] mx-auto px-6 py-8">
            {activeLayer === 'overview' && <OverviewLayer />}
            {activeLayer === 'fides' && <FidesLayer />}
            {activeLayer === 'products' && <ProductsLayer activeProduct={activeProduct} setActiveProduct={setActiveProduct} />}
            {activeLayer === 'engines' && <EnginesLayer />}
            {activeLayer === 'data' && <DataLayer />}
            {activeLayer === 'operations' && <OperationsLayer />}
            {activeLayer === 'security' && <SecurityLayer activePhase={activeSecurityPhase} setActivePhase={setActiveSecurityPhase} />}
            {activeLayer === 'roadmap' && <RoadmapLayer activePhase={activePhase} setActivePhase={setActivePhase} />}
          </main>
        </div>
      );
    }

    // ============================================
    // SECURITY LAYER - Ciberseguridad
    // ============================================
    function SecurityLayer({ activePhase, setActivePhase }) {
      const pillars = [
        {
          id: 1,
          icon: BookOpen,
          title: 'Gobierno y Marco Normativo',
          color: 'cyan',
          desc: 'Estructura de reglas, responsabilidades y procesos que guían cómo protegemos la información.',
          items: [
            { name: 'Política General de Seguridad', detail: 'Principios de confidencialidad, integridad y disponibilidad' },
            { name: 'Comité Interno de Riesgos', detail: 'GM, CTO, Ops Manager - reuniones mensuales' },
            { name: 'Control de Versiones', detail: 'Revisión anual mínima, responsables definidos' },
          ],
          status: 'active'
        },
        {
          id: 2,
          icon: AlertTriangle,
          title: 'Gestión de Riesgos',
          color: 'amber',
          desc: 'Identificar qué podría salir mal, evaluar gravedad y tomar medidas preventivas.',
          items: [
            { name: 'Metodología ISO 27005', detail: '5 etapas: identificación, evaluación, tratamiento, monitoreo, comunicación' },
            { name: '7 Categorías de Riesgo', detail: 'Crédito, operacional, tecnológico, legal, reputacional, estratégico, liquidez' },
            { name: 'Infraestructura Redundante', detail: 'Cloud + monitoreo continuo para sistema scoring' },
          ],
          status: 'active'
        },
        {
          id: 3,
          icon: Lock,
          title: 'Protección de Datos y Cifrado',
          color: 'violet',
          desc: 'Convierte información en código ilegible para quien no tenga la llave correcta.',
          items: [
            { name: 'Datos en Reposo', detail: 'AES-256 en GCP + CMEK con rotación anual' },
            { name: 'Datos en Tránsito', detail: 'TLS 1.2+ en todas las comunicaciones' },
            { name: 'APIs y Conexiones', detail: 'Mismo protocolo que transacciones bancarias' },
          ],
          status: 'active'
        },
        {
          id: 4,
          icon: UserCog,
          title: 'Control de Acceso',
          color: 'emerald',
          desc: 'Solo las personas correctas acceden a los sistemas y datos necesarios para su trabajo.',
          items: [
            { name: 'Privilegio Mínimo', detail: 'Acceso solo a lo necesario para la función' },
            { name: 'Flujo de Solicitud', detail: 'Notion → CISO → Validación → Acceso temporal 30 días' },
            { name: 'Revisiones Periódicas', detail: 'Eliminación de accesos obsoletos' },
          ],
          status: 'active'
        },
        {
          id: 5,
          icon: Server,
          title: 'Separación de Ambientes',
          color: 'blue',
          desc: 'Mantener completamente separados los entornos de desarrollo del sistema productivo.',
          items: [
            { name: 'Clusters K8s Independientes', detail: 'Development (pruebas) vs Production (datos reales)' },
            { name: 'Aislamiento Total', detail: 'BD y storage separados por ambiente' },
            { name: 'Protección Clientes', detail: 'Error en dev nunca afecta producción' },
          ],
          status: 'active'
        },
        {
          id: 6,
          icon: Monitor,
          title: 'Monitoreo y Detección',
          color: 'rose',
          desc: 'Vigilar constantemente sistemas para detectar actividades sospechosas.',
          items: [
            { name: 'IDS/IPS', detail: 'Sistemas de detección y prevención de intrusiones' },
            { name: 'Security Command Center', detail: 'Monitoreo continuo en GCP' },
            { name: 'Posture Management', detail: '15% → 30% cumplimiento ISO 27001 en 1 mes' },
          ],
          status: 'development'
        },
        {
          id: 7,
          icon: Users,
          title: 'Concientización y Cultura',
          color: 'orange',
          desc: 'Las personas son frecuentemente el eslabón más débil. Capacitación reduce riesgo.',
          items: [
            { name: 'Programa Awareness 2025', detail: 'Capacitación obligatoria para todos' },
            { name: 'Temas Cubiertos', detail: 'Phishing, contraseñas, ingeniería social, respuesta incidentes' },
            { name: 'Evidencia de Cumplimiento', detail: 'Certificado o captura por colaborador' },
          ],
          status: 'planned'
        },
        {
          id: 8,
          icon: Globe,
          title: 'Gestión de Proveedores',
          color: 'teal',
          desc: 'Asegurar que terceros con acceso a información cumplan estándares de seguridad.',
          items: [
            { name: 'Acuerdo Marco (MSA)', detail: 'Confidencialidad 5 años post-contrato' },
            { name: 'Notificación Incidentes', detail: 'Máximo 72 horas' },
            { name: 'Derecho de Auditoría', detail: 'Matriz de control de proveedores' },
          ],
          status: 'active'
        },
      ];

      const roadmapPhases = [
        { 
          n: 1, 
          name: 'Base', 
          q: 'Q4 2025', 
          focus: 'Fundamentos',
          items: ['Políticas base formalizadas', 'Control de accesos implementado', 'Monitoreo de perímetro activo', 'Comité de Riesgos operativo'] 
        },
        { 
          n: 2, 
          name: 'Activos', 
          q: 'Q1 2026', 
          focus: 'Gestión de Activos',
          items: ['Inventario de activos completo', 'Clasificación de información', 'Programa de awareness lanzado', 'Capacitaciones completadas'] 
        },
        { 
          n: 3, 
          name: 'Continuidad', 
          q: 'Q2 2026', 
          focus: 'BCP/DRP',
          items: ['Privacidad de datos (RGPD-like)', 'Business Continuity Plan', 'Disaster Recovery Plan', 'Pruebas de recuperación'] 
        },
        { 
          n: 4, 
          name: 'Métricas', 
          q: 'Q3 2026', 
          focus: 'Medición',
          items: ['KPIs de seguridad definidos', 'Matriz RACI completa', 'Dashboards de cumplimiento', 'Reporting automatizado'] 
        },
        { 
          n: 5, 
          name: 'Certificación', 
          q: 'Q4 2026', 
          focus: 'ISO 27001',
          items: ['Auditoría interna completada', 'Remediación de hallazgos', 'Auditoría externa ISO 27001', 'Certificación obtenida'] 
        },
      ];

      const currentPhase = roadmapPhases[activePhase - 1];

      return (
        <div className="space-y-8">
          {/* Hero */}
          <div className="bg-gradient-to-br from-emerald-500/10 to-teal-500/5 rounded-2xl border border-emerald-500/30 p-8">
            <div className="flex items-start gap-4">
              <ShieldCheck className="w-12 h-12 text-emerald-400" />
              <div>
                <h2 className="text-3xl font-bold text-emerald-400">Postura de Ciberseguridad</h2>
                <p className="text-slate-400">Programa alineado con ISO 27001:2022 — Certificación objetivo Q4-2026</p>
                <p className="text-slate-300 mt-4 max-w-2xl leading-relaxed">
                  PROPIO construye seguridad como parte integral de la operación, no como checklist. 
                  <span className="text-emerald-400 font-semibold"> 21 políticas formalizadas</span> cubriendo 
                  8 pilares fundamentales con controles técnicos funcionando, procesos operando y cultura construyéndose.
                </p>
              </div>
            </div>
          </div>

          {/* Stats */}
          <div className="grid grid-cols-5 gap-4">
            <StatCard number="21" label="Políticas Formalizadas" color="emerald" />
            <StatCard number="8" label="Pilares de Seguridad" color="cyan" />
            <StatCard number="30%" label="Cumplimiento ISO" color="violet" />
            <StatCard number="7" label="Categorías de Riesgo" color="amber" />
            <StatCard number="Q4-26" label="Meta Certificación" color="rose" />
          </div>

          {/* 8 Pillars Grid */}
          <div className="space-y-4">
            <SectionHeader title="Los 8 Pilares de Seguridad" subtitle="Marco integral de protección de la información" />
            
            <div className="grid grid-cols-2 gap-6">
              {pillars.map((pillar) => (
                <SecurityPillarCard key={pillar.id} pillar={pillar} />
              ))}
            </div>
          </div>

          {/* Security Roadmap */}
          <div className="space-y-6">
            <SectionHeader title="Roadmap de Maduración" subtitle="Camino hacia certificación ISO 27001:2022" />

            {/* Timeline */}
            <div className="relative">
              <div className="absolute top-6 left-0 right-0 h-1 bg-slate-800 rounded-full"></div>
              <div className="absolute top-6 left-0 h-1 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full" 
                   style={{ width: `${(activePhase / 5) * 100}%` }}></div>
              <div className="relative grid grid-cols-5 gap-4">
                {roadmapPhases.map((p) => (
                  <div
                    key={p.n}
                    onClick={() => setActivePhase(p.n)}
                    className={`relative pt-10 cursor-pointer transition-all ${activePhase === p.n ? 'scale-105' : 'opacity-70 hover:opacity-100'}`}
                  >
                    <div className={`absolute top-4 left-1/2 -translate-x-1/2 w-4 h-4 rounded-full border-2 ${
                      activePhase >= p.n ? 'bg-emerald-500 border-emerald-400' : 'bg-slate-700 border-slate-600'
                    }`}></div>
                    <div className={`rounded-xl border p-4 ${
                      activePhase === p.n ? 'bg-emerald-500/10 border-emerald-500/50' : 'bg-slate-900/50 border-slate-800'
                    }`}>
                      <div className="flex justify-between text-xs mb-2">
                        <span className={activePhase === p.n ? 'text-emerald-400' : 'text-slate-500'}>{p.q}</span>
                      </div>
                      <h4 className={`font-bold text-sm ${activePhase === p.n ? 'text-emerald-400' : 'text-white'}`}>
                        F{p.n}: {p.name}
                      </h4>
                      <p className="text-xs text-slate-500 mt-1">{p.focus}</p>
                    </div>
                  </div>
                ))}
              </div>
            </div>

            {/* Phase Detail */}
            <div className="bg-slate-900/50 rounded-xl border border-emerald-500/30 p-6">
              <div className="flex items-start justify-between mb-4">
                <div>
                  <h3 className="text-xl font-bold text-white">
                    Fase {currentPhase.n}: {currentPhase.name}
                    <span className="text-slate-400 text-sm font-normal ml-2">— {currentPhase.q}</span>
                  </h3>
                  <p className="text-emerald-400 text-sm">{currentPhase.focus}</p>
                </div>
                <div className="px-3 py-1 bg-emerald-500/20 text-emerald-400 rounded-lg text-sm">
                  {currentPhase.n === 1 ? 'En Progreso' : currentPhase.n < 3 ? 'Próximo' : 'Planificado'}
                </div>
              </div>
              <div className="grid grid-cols-2 gap-4">
                {currentPhase.items.map((item, i) => (
                  <div key={i} className="flex items-center gap-3 bg-slate-800/50 rounded-lg p-3">
                    <div className={`w-8 h-8 rounded-lg flex items-center justify-center ${
                      currentPhase.n === 1 ? 'bg-emerald-500/20' : 'bg-slate-700'
                    }`}>
                      <span className={`text-sm font-bold ${currentPhase.n === 1 ? 'text-emerald-400' : 'text-slate-400'}`}>
                        {i + 1}
                      </span>
                    </div>
                    <span className="text-slate-300 text-sm">{item}</span>
                  </div>
                ))}
              </div>
            </div>
          </div>

          {/* Key Message */}
          <div className="bg-gradient-to-r from-emerald-500/10 to-teal-500/10 rounded-xl border border-emerald-500/30 p-6">
            <h3 className="text-lg font-semibold text-white mb-3">Filosofía de Seguridad PROPIO</h3>
            <p className="text-slate-300 leading-relaxed">
              La seguridad no es solo documentación: son <span className="text-emerald-400">controles técnicos funcionando</span> (cifrado, 
              separación de ambientes, monitoreo), <span className="text-cyan-400">procesos operando</span> (revisión de accesos, 
              comité de riesgos), y <span className="text-violet-400">cultura construyéndose</span> (capacitaciones, responsabilidades claras). 
              El objetivo es certificación ISO 27001 en Q4-2026 como validación externa de nuestra postura.
            </p>
          </div>
        </div>
      );
    }

    function SecurityPillarCard({ pillar }) {
      const colorMap = {
        cyan: { bg: 'from-cyan-500/10 to-cyan-500/5', border: 'border-cyan-500/30', text: 'text-cyan-400', icon: 'bg-cyan-500/20' },
        amber: { bg: 'from-amber-500/10 to-amber-500/5', border: 'border-amber-500/30', text: 'text-amber-400', icon: 'bg-amber-500/20' },
        violet: { bg: 'from-violet-500/10 to-violet-500/5', border: 'border-violet-500/30', text: 'text-violet-400', icon: 'bg-violet-500/20' },
        emerald: { bg: 'from-emerald-500/10 to-emerald-500/5', border: 'border-emerald-500/30', text: 'text-emerald-400', icon: 'bg-emerald-500/20' },
        blue: { bg: 'from-blue-500/10 to-blue-500/5', border: 'border-blue-500/30', text: 'text-blue-400', icon: 'bg-blue-500/20' },
        rose: { bg: 'from-rose-500/10 to-rose-500/5', border: 'border-rose-500/30', text: 'text-rose-400', icon: 'bg-rose-500/20' },
        orange: { bg: 'from-orange-500/10 to-orange-500/5', border: 'border-orange-500/30', text: 'text-orange-400', icon: 'bg-orange-500/20' },
        teal: { bg: 'from-teal-500/10 to-teal-500/5', border: 'border-teal-500/30', text: 'text-teal-400', icon: 'bg-teal-500/20' },
      };
      
      const colors = colorMap[pillar.color] || colorMap.cyan;
      const Icon = pillar.icon;

      return (
        <div className={`bg-gradient-to-br ${colors.bg} rounded-xl border ${colors.border} p-5`}>
          <div className="flex items-start gap-4 mb-4">
            <div className={`w-12 h-12 ${colors.icon} rounded-lg flex items-center justify-center flex-shrink-0`}>
              <Icon className={`w-6 h-6 ${colors.text}`} />
            </div>
            <div className="flex-1">
              <div className="flex items-center justify-between">
                <h4 className={`font-bold ${colors.text}`}>{pillar.title}</h4>
                <StatusBadge status={pillar.status} />
              </div>
              <p className="text-xs text-slate-400 mt-1">{pillar.desc}</p>
            </div>
          </div>
          <div className="space-y-2">
            {pillar.items.map((item, i) => (
              <div key={i} className="flex items-start gap-2 bg-slate-800/30 rounded-lg p-2">
                <CheckCircle2 className={`w-4 h-4 ${colors.text} mt-0.5 flex-shrink-0`} />
                <div>
                  <span className="text-sm text-white">{item.name}</span>
                  <p className="text-xs text-slate-500">{item.detail}</p>
                </div>
              </div>
            ))}
          </div>
        </div>
      );
    }

    // ============================================
    // OVERVIEW LAYER
    // ============================================
    function OverviewLayer() {
      return (
        <div className="space-y-8">
          {/* Hero */}
          <div className="text-center py-6">
            <h2 className="text-3xl font-bold mb-2">
              <span className="text-cyan-400">PROPIO OS</span>
              <span className="text-slate-400 ml-2">— Crédito Alternativo</span>
            </h2>
            <p className="text-slate-400 max-w-3xl mx-auto">
              Plataforma modular para productos de crédito a población no bancarizada. 
              El diferenciador es <span className="text-violet-400 font-semibold">FIDES</span>: data alternativa que permite underwritear donde otros no pueden.
            </p>
          </div>

          {/* Value Props */}
          <div className="grid grid-cols-3 gap-6">
            <ValuePropCard 
              icon={Fingerprint} 
              title="FIDES" 
              color="violet"
              desc="Data alternativa + RBI Score. Ventaja competitiva en underwriting de excluidos del sistema tradicional."
            />
            <ValuePropCard 
              icon={Brain} 
              title="Risk Engine" 
              color="cyan"
              desc="Motor agnóstico al producto. Scoring cliente + activo + conducta configurable por vertical."
            />
            <ValuePropCard 
              icon={Package} 
              title="Multi-Producto" 
              color="emerald"
              desc="Rent-to-Own hoy. Crédito consumo, adelantos y gig finance mañana. Misma plataforma."
            />
          </div>

          {/* Architecture Simplified */}
          <div className="bg-slate-900/50 rounded-2xl border border-slate-800 p-8">
            <h3 className="text-lg font-semibold text-white mb-6">Arquitectura del Sistema</h3>
            
            <div className="space-y-4">
              {/* Products */}
              <div className="flex items-center gap-4">
                <span className="w-32 text-xs text-slate-500 text-right">PRODUCTOS</span>
                <div className="flex-1 flex gap-2">
                  <ModuleChip icon={Home} label="Rent-to-Own" status="live" />
                  <ModuleChip icon={Wallet} label="Crédito Consumo" status="planned" />
                  <ModuleChip icon={CreditCard} label="Adelantos" status="planned" />
                  <ModuleChip icon={Briefcase} label="Gig Finance" status="research" />
                </div>
              </div>

              <ArrowDown className="w-5 h-5 text-slate-600 mx-auto" />

              {/* Core */}
              <div className="flex items-center gap-4">
                <span className="w-32 text-xs text-slate-500 text-right">CORE</span>
                <div className="flex-1 flex gap-2">
                  <ModuleChip icon={Brain} label="Risk Engine" status="dev" />
                  <ModuleChip icon={Workflow} label="Originación" status="dev" />
                  <ModuleChip icon={CreditCard} label="Cobranza" status="dev" />
                  <ModuleChip icon={Bell} label="Alertas" status="design" />
                </div>
              </div>

              <ArrowDown className="w-5 h-5 text-violet-500 mx-auto" />

              {/* FIDES */}
              <div className="flex items-center gap-4 bg-violet-500/5 -mx-8 px-8 py-4 border-y border-violet-500/20">
                <span className="w-32 text-xs text-violet-400 text-right font-semibold">FIDES ✦</span>
                <div className="flex-1 flex gap-2">
                  <ModuleChip icon={Activity} label="Behavioral Data" status="dev" highlight />
                  <ModuleChip icon={LineChart} label="RBI Score" status="priority" highlight />
                  <ModuleChip icon={Users} label="Identity Graph" status="planned" highlight />
                  <ModuleChip icon={TrendingUp} label="Rent Reporting" status="planned" highlight />
                </div>
              </div>

              <ArrowDown className="w-5 h-5 text-emerald-500 mx-auto" />

              {/* Security Layer */}
              <div className="flex items-center gap-4 bg-emerald-500/5 -mx-8 px-8 py-4 border-y border-emerald-500/20">
                <span className="w-32 text-xs text-emerald-400 text-right font-semibold">SEGURIDAD ⛨</span>
                <div className="flex-1 flex gap-2">
                  <ModuleChip icon={Shield} label="ISO 27001" status="dev" />
                  <ModuleChip icon={Lock} label="Cifrado AES-256" status="live" />
                  <ModuleChip icon={Key} label="Control Acceso" status="live" />
                  <ModuleChip icon={Monitor} label="Monitoreo" status="dev" />
                </div>
              </div>

              <ArrowDown className="w-5 h-5 text-slate-600 mx-auto" />

              {/* Integrations */}
              <div className="flex items-center gap-4">
                <span className="w-32 text-xs text-slate-500 text-right">EXTERNO</span>
                <div className="flex-1 flex flex-wrap gap-2">
                  {['Sinacofi', 'CMF', 'SII', 'Floid', 'Bancos', 'Gig APIs', 'Open Banking'].map(i => (
                    <span key={i} className="px-2 py-1 bg-slate-800 rounded text-xs text-slate-400">{i}</span>
                  ))}
                </div>
              </div>
            </div>
          </div>

          {/* Core Thesis */}
          <div className="bg-gradient-to-r from-violet-500/10 to-cyan-500/10 rounded-xl border border-violet-500/30 p-6">
            <h3 className="text-lg font-bold text-white mb-3">Tesis Central</h3>
            <p className="text-slate-300 leading-relaxed">
              Rent-to-Own es el <span className="text-cyan-400">primer caso de uso</span>, no el límite. 
              Genera data conductual única que alimenta FIDES. Los componentes core (Risk Engine, Originación, Cobranza) 
              son <span className="text-emerald-400">agnósticos al producto</span>. 
              FIDES + RBI Score es el <span className="text-violet-400">moat</span>: permite underwritear donde bureaus tradicionales no pueden, 
              habilitando expansión a crédito consumo, adelantos, gig finance y más.
            </p>
          </div>

          {/* Stats */}
          <div className="grid grid-cols-5 gap-4">
            <StatCard number="5+" label="Productos Potenciales" color="emerald" />
            <StatCard number="3" label="Scores Propietarios" color="violet" />
            <StatCard number="5" label="Máquinas de Estado" color="cyan" />
            <StatCard number="45+" label="Alertas" color="rose" />
            <StatCard number="$213M" label="Inversión 2025" color="amber" />
          </div>
        </div>
      );
    }

    // ============================================
    // FIDES LAYER - El Diferenciador
    // ============================================
    function FidesLayer() {
      return (
        <div className="space-y-8">
          {/* Hero */}
          <div className="bg-gradient-to-br from-violet-500/10 to-purple-500/5 rounded-2xl border border-violet-500/30 p-8">
            <div className="flex items-start gap-4">
              <Fingerprint className="w-12 h-12 text-violet-400" />
              <div>
                <h2 className="text-3xl font-bold text-violet-400">FIDES</h2>
                <p className="text-slate-400">Financial Identity & Data Enrichment System</p>
                <p className="text-slate-300 mt-4 max-w-2xl leading-relaxed">
                  Repositorio propietario de data alternativa. FIDES es el <span className="text-violet-400 font-semibold">activo estratégico</span> que 
                  permite underwritear población excluida del sistema financiero y construye ventaja competitiva sostenible.
                </p>
              </div>
            </div>
          </div>

          {/* Problem vs Solution */}
          <div className="grid grid-cols-2 gap-6">
            <div className="bg-slate-900/50 rounded-xl border border-red-500/30 p-6">
              <h3 className="text-lg font-semibold text-red-400 mb-4 flex items-center gap-2">
                <AlertTriangle className="w-5 h-5" />
                Problema: Underwriting Tradicional
              </h3>
              <ul className="space-y-2 text-sm text-slate-400">
                {[
                  'Depende de historial crediticio formal (bureaus)',
                  'Excluye independientes, gig economy, informales',
                  'No captura comportamiento de pago en arriendo',
                  'Scoring estático, no conductual',
                  '~40% de Chile sin acceso a crédito formal'
                ].map((item, i) => (
                  <li key={i} className="flex items-start gap-2">
                    <span className="text-red-400">✗</span>{item}
                  </li>
                ))}
              </ul>
            </div>
            <div className="bg-slate-900/50 rounded-xl border border-emerald-500/30 p-6">
              <h3 className="text-lg font-semibold text-emerald-400 mb-4 flex items-center gap-2">
                <Sparkles className="w-5 h-5" />
                Solución: FIDES + Data Alternativa
              </h3>
              <ul className="space-y-2 text-sm text-slate-300">
                {[
                  'Historial de pago de arriendo (señal #1 de capacidad)',
                  'Data gig economy (Uber, Rappi, Cornershop)',
                  'RBI Score: comportamiento real, no solo historial',
                  'Identity Graph: visión 360° del cliente',
                  'Rent Reporting: construye historial para el cliente'
                ].map((item, i) => (
                  <li key={i} className="flex items-start gap-2">
                    <span className="text-emerald-400">✓</span>{item}
                  </li>
                ))}
              </ul>
            </div>
          </div>

          {/* Components */}
          <div className="space-y-4">
            <h3 className="text-xl font-bold text-white">Componentes FIDES</h3>
            <div className="grid grid-cols-3 gap-6">
              <FidesCard
                icon={Activity}
                title="Behavioral Data Capture"
                status="development"
                desc="Captura de patrones de comportamiento"
                items={['Historial pagos PROPIO', 'Patrones de ahorro', 'Timing de pagos', 'Comunicación proactiva']}
              />
              <FidesCard
                icon={LineChart}
                title="RBI Score Engine"
                status="priority"
                desc="Score conductual propietario"
                items={['Payment Consistency (40%)', 'Payment Timing (25%)', 'Housing Priority (20%)', 'Stability (15%)']}
              />
              <FidesCard
                icon={Users}
                title="Identity Graph"
                status="planned"
                desc="Visión unificada del cliente"
                items={['Consolidación identidades', 'Historial cross-producto', 'Red de vínculos', 'Perfil evolutivo']}
              />
            </div>
            <div className="grid grid-cols-2 gap-6">
              <FidesCard
                icon={RefreshCw}
                title="Data Enrichment Pipeline"
                status="development"
                desc="Ingesta de fuentes externas"
                items={['APIs Gig Economy', 'Open Banking', 'Validación SII', 'Data mercado inmobiliario']}
              />
              <FidesCard
                icon={TrendingUp}
                title="Rent Reporting"
                status="planned"
                desc="Reporte a bureaus — flywheel inclusión"
                items={['Reporte mensual Sinacofi/Equifax', 'Construye historial del cliente', 'Incentiva buen comportamiento', 'Habilita crédito formal futuro']}
              />
            </div>
          </div>

          {/* Flywheel */}
          <div className="bg-slate-900/50 rounded-xl border border-violet-500/30 p-6">
            <h3 className="text-lg font-semibold text-violet-400 mb-4">Flywheel FIDES</h3>
            <div className="flex items-center justify-between gap-3">
              {[
                { n: '1', t: 'Captura', d: 'Cliente paga cuotas' },
                { n: '2', t: 'Enriquece', d: 'Data → RBI Score' },
                { n: '3', t: 'Reporta', d: 'Rent Reporting' },
                { n: '4', t: 'Habilita', d: 'Más crédito' },
                { n: '5', t: 'Escala', d: 'Nuevos productos' },
              ].map((step, i, arr) => (
                <React.Fragment key={step.n}>
                  <div className="flex-1 bg-slate-800/50 rounded-lg p-3 border border-violet-500/20 text-center">
                    <span className="w-6 h-6 rounded-full bg-violet-500/20 text-violet-400 inline-flex items-center justify-center text-xs font-bold">{step.n}</span>
                    <p className="font-medium text-white text-sm mt-1">{step.t}</p>
                    <p className="text-xs text-slate-400">{step.d}</p>
                  </div>
                  {i < arr.length - 1 && <ArrowRight className="w-5 h-5 text-violet-500/50 flex-shrink-0" />}
                </React.Fragment>
              ))}
            </div>
            <div className="mt-4 p-3 bg-violet-500/10 border border-violet-500/30 rounded-lg">
              <p className="text-sm text-violet-300">
                <Sparkles className="w-4 h-4 inline mr-1" />
                El flywheel genera data propietaria → mejora underwriting → habilita productos → genera más data. 
                Moat que se fortalece con escala.
              </p>
            </div>
          </div>

          {/* Competitive Advantage */}
          <div className="bg-gradient-to-r from-violet-500/10 to-cyan-500/10 rounded-xl border border-violet-500/30 p-6">
            <h3 className="text-lg font-semibold text-white mb-4">Ventaja Competitiva</h3>
            <div className="grid grid-cols-3 gap-6 text-center">
              <div>
                <p className="text-3xl font-bold text-violet-400">Data</p>
                <p className="text-sm text-slate-400 mt-1">Cada operación genera data única que competidores no tienen</p>
              </div>
              <div>
                <p className="text-3xl font-bold text-cyan-400">Network</p>
                <p className="text-sm text-slate-400 mt-1">Identity Graph conecta clientes cross-producto</p>
              </div>
              <div>
                <p className="text-3xl font-bold text-emerald-400">Moat</p>
                <p className="text-sm text-slate-400 mt-1">RBI Score mejora con volumen — winner takes most</p>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // ============================================
    // PRODUCTS LAYER
    // ============================================
    function ProductsLayer({ activeProduct, setActiveProduct }) {
      const products = [
        {
          id: 'renttoown', name: 'Rent-to-Own', icon: Home, status: 'live',
          desc: 'Arriendo con opción de compra. Producto ancla que genera data FIDES.',
          metrics: { AUM: '$2.5B CLP', Clientes: '150+', Ticket: '~2,500 UF' },
          usesAsset: true, usesCredit: true, usesRBI: true,
          specific: ['Escrituración', 'Exit a Banco', 'Asset Score', 'Portal Inmobiliarias']
        },
        {
          id: 'consumo', name: 'Crédito Consumo', icon: Wallet, status: 'planned',
          desc: 'Préstamos personales para clientes con historial PROPIO.',
          metrics: { Target: 'Clientes PROPIO', Ticket: '50-200 UF', Plazo: '12-36 meses' },
          usesAsset: false, usesCredit: true, usesRBI: true,
          specific: ['Cross-sell engine', 'Scoring simplificado', 'Desembolso rápido']
        },
        {
          id: 'adelanto', name: 'Adelanto Arriendo', icon: CreditCard, status: 'planned',
          desc: 'Liquidez para arrendatarios que no van a rent-to-own.',
          metrics: { Target: 'Arrendatarios', Ticket: '1-3 arriendos', Plazo: '3-6 meses' },
          usesAsset: false, usesCredit: true, usesRBI: true,
          specific: ['Verificación contrato', 'Pago automático', 'Integración arriendos']
        },
        {
          id: 'mejoramiento', name: 'Mejoramiento', icon: Wrench, status: 'planned',
          desc: 'Crédito para mejoras con activo PROPIO como respaldo.',
          metrics: { Target: 'En ahorro', Ticket: '100-500 UF', Plazo: '12-24 meses' },
          usesAsset: true, usesCredit: true, usesRBI: true,
          specific: ['Colateral activo', 'Supervisión obras', 'Aumento valor']
        },
        {
          id: 'gig', name: 'Gig Finance', icon: Briefcase, status: 'research',
          desc: 'Productos para trabajadores independientes y gig economy.',
          metrics: { Target: 'Independientes', Productos: 'Adelantos, capital', Data: 'APIs gig' },
          usesAsset: false, usesCredit: false, usesRBI: true,
          specific: ['Integración Uber/Rappi', 'Scoring alternativo puro', 'Flujo de caja']
        },
      ];

      const current = products.find(p => p.id === activeProduct);

      return (
        <div className="space-y-8">
          <SectionHeader title="Portafolio de Productos" subtitle="Arquitectura multi-producto sobre PROPIO OS + FIDES" />

          {/* Product Tabs */}
          <div className="flex gap-3 overflow-x-auto pb-2">
            {products.map((p) => (
              <button
                key={p.id}
                onClick={() => setActiveProduct(p.id)}
                className={`flex items-center gap-2 px-4 py-3 rounded-lg border transition-all whitespace-nowrap ${
                  activeProduct === p.id
                    ? 'bg-cyan-500/20 border-cyan-500/50 text-cyan-400'
                    : 'bg-slate-900/50 border-slate-800 text-slate-400 hover:border-slate-700'
                }`}
              >
                <p.icon className="w-5 h-5" />
                <span className="font-medium">{p.name}</span>
                <StatusBadge status={p.status} />
              </button>
            ))}
          </div>

          {/* Product Detail */}
          {current && (
            <div className="bg-slate-900/50 rounded-xl border border-slate-800 p-6">
              <div className="flex items-start justify-between mb-6">
                <div className="flex items-center gap-4">
                  <div className="w-12 h-12 bg-cyan-500/20 rounded-lg flex items-center justify-center">
                    <current.icon className="w-6 h-6 text-cyan-400" />
                  </div>
                  <div>
                    <h3 className="text-xl font-bold text-white">{current.name}</h3>
                    <p className="text-slate-400">{current.desc}</p>
                  </div>
                </div>
                <StatusBadge status={current.status} large />
              </div>

              <div className="grid grid-cols-3 gap-6">
                {/* Metrics */}
                <div className="bg-slate-800/50 rounded-lg p-4">
                  <h4 className="text-sm text-slate-500 mb-3">Métricas / Target</h4>
                  {Object.entries(current.metrics).map(([k, v]) => (
                    <div key={k} className="flex justify-between py-1">
                      <span className="text-slate-400 text-sm">{k}</span>
                      <span className="text-white font-medium">{v}</span>
                    </div>
                  ))}
                </div>

                {/* Scores */}
                <div className="bg-slate-800/50 rounded-lg p-4">
                  <h4 className="text-sm text-slate-500 mb-3">Scores Utilizados</h4>
                  <ScoreRow name="Credit Score" used={current.usesCredit} />
                  <ScoreRow name="Asset Score" used={current.usesAsset} />
                  <ScoreRow name="RBI Score (FIDES)" used={current.usesRBI} highlight />
                </div>

                {/* Specific */}
                <div className="bg-slate-800/50 rounded-lg p-4">
                  <h4 className="text-sm text-slate-500 mb-3">Componentes Específicos</h4>
                  <div className="flex flex-wrap gap-2">
                    {current.specific.map((s) => (
                      <span key={s} className="px-2 py-1 bg-slate-700 rounded text-xs text-slate-300">{s}</span>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Shared vs Specific */}
          <div className="grid grid-cols-2 gap-6">
            <div className="bg-slate-900/50 rounded-xl border border-emerald-500/30 p-6">
              <h3 className="text-lg font-semibold text-emerald-400 mb-4 flex items-center gap-2">
                <Layers className="w-5 h-5" />
                Componentes Compartidos
              </h3>
              <div className="space-y-2">
                {['FIDES + RBI Score', 'Credit Score', 'Risk Engine', 'Originación', 'Cobranza', 'Alertas', 'Portal Clientes'].map((c) => (
                  <div key={c} className="flex items-center gap-2 text-sm">
                    <CheckCircle2 className="w-4 h-4 text-emerald-400" />
                    <span className="text-slate-300">{c}</span>
                  </div>
                ))}
              </div>
            </div>
            <div className="bg-slate-900/50 rounded-xl border border-amber-500/30 p-6">
              <h3 className="text-lg font-semibold text-amber-400 mb-4 flex items-center gap-2">
                <GitBranch className="w-5 h-5" />
                Componentes Específicos
              </h3>
              <div className="space-y-2">
                {['Asset Score (con colateral)', 'Escrituración (R2O)', 'Portal Inmobiliarias (R2O)', 'Gig APIs (Gig Finance)', 'Cross-sell (Consumo)'].map((c) => (
                  <div key={c} className="flex items-center gap-2 text-sm">
                    <Settings className="w-4 h-4 text-amber-400" />
                    <span className="text-slate-300">{c}</span>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    }

    // ============================================
    // ENGINES LAYER
    // ============================================
    function EnginesLayer() {
      return (
        <div className="space-y-8">
          <SectionHeader title="Motores de Decisión" subtitle="Risk Engine y Scoring — agnósticos al producto" />

          {/* Risk Engine */}
          <div className="bg-gradient-to-br from-slate-900 to-slate-800 rounded-2xl border border-cyan-500/30 p-8">
            <div className="flex items-start justify-between mb-6">
              <div>
                <h3 className="text-2xl font-bold text-cyan-400">Risk Engine</h3>
                <p className="text-slate-400">Motor de evaluación configurable por producto</p>
              </div>
              <StatusBadge status="dev" />
            </div>

            {/* Flow */}
            <div className="flex items-center gap-4 mb-8">
              {[
                { n: '1', t: 'Input', items: ['Datos cliente', 'Datos activo*', 'FIDES behavioral'] },
                { n: '2', t: 'Scoring', items: ['Credit Score', 'Asset Score*', 'RBI Score'] },
                { n: '3', t: 'Matriz', items: ['Nivel 0-4', 'Decisión', 'Condiciones'] },
                { n: '4', t: 'Output', items: ['Aprobado/Rechazado', 'Tasa', 'Monto máximo'] },
              ].map((step, i, arr) => (
                <React.Fragment key={step.n}>
                  <div className="flex-1 bg-slate-800/50 rounded-lg p-4 border border-slate-700">
                    <div className="flex items-center gap-2 mb-2">
                      <span className="w-6 h-6 rounded-full bg-cyan-500/20 text-cyan-400 flex items-center justify-center text-xs font-bold">{step.n}</span>
                      <span className="font-medium text-white">{step.t}</span>
                    </div>
                    <ul className="text-xs text-slate-400">
                      {step.items.map(item => <li key={item}>• {item}</li>)}
                    </ul>
                  </div>
                  {i < arr.length - 1 && <ArrowRight className="w-6 h-6 text-cyan-500/50 flex-shrink-0" />}
                </React.Fragment>
              ))}
            </div>

            {/* Scores */}
            <div className="grid grid-cols-3 gap-6">
              <ScoringCard
                title="Credit Score"
                range="500-999"
                usage="Todos los productos"
                color="cyan"
                components={[
                  { name: 'Score Sinacofi', weight: '40%' },
                  { name: 'Comportamiento CMF', weight: '25%' },
                  { name: 'Carga financiera', weight: '20%' },
                  { name: 'Estabilidad laboral', weight: '15%' },
                ]}
              />
              <ScoringCard
                title="Asset Score"
                range="0-1000"
                usage="R2O, Mejoramiento"
                color="emerald"
                components={[
                  { name: 'Ubicación', weight: '35%' },
                  { name: 'Liquidez mercado', weight: '30%' },
                  { name: 'Calidad construcción', weight: '20%' },
                  { name: 'Valorización', weight: '15%' },
                ]}
              />
              <ScoringCard
                title="RBI Score (FIDES)"
                range="0-100"
                usage="Todos — diferenciador"
                color="violet"
                highlight
                components={[
                  { name: 'Payment Consistency', weight: '40%' },
                  { name: 'Payment Timing', weight: '25%' },
                  { name: 'Housing Priority', weight: '20%' },
                  { name: 'Stability', weight: '15%' },
                ]}
              />
            </div>
          </div>

          {/* Risk Matrix */}
          <div className="bg-slate-900/50 rounded-xl border border-slate-800 p-6">
            <h3 className="text-lg font-semibold text-white mb-4">Matriz de Riesgo (Asset × Credit)</h3>
            <div className="overflow-x-auto">
              <table className="w-full text-sm">
                <thead>
                  <tr className="text-slate-400">
                    <th className="p-3 text-left">Asset \ Credit</th>
                    <th className="p-3 text-center">&gt;875</th>
                    <th className="p-3 text-center">750-875</th>
                    <th className="p-3 text-center">625-750</th>
                    <th className="p-3 text-center">500-625</th>
                    <th className="p-3 text-center">&lt;500</th>
                  </tr>
                </thead>
                <tbody>
                  {[
                    { label: '>800', values: [4, 4, 3, 2, 1] },
                    { label: '700-800', values: [4, 4, 3, 2, 1] },
                    { label: '600-700', values: [4, 3, 3, 2, 1] },
                    { label: '500-600', values: [3, 3, 2, 1, 0] },
                    { label: '<500', values: [2, 2, 1, 0, 0] },
                  ].map((row) => (
                    <tr key={row.label} className="border-t border-slate-800">
                      <td className="p-3 text-slate-400">{row.label}</td>
                      {row.values.map((v, i) => (
                        <td key={i} className={`p-3 text-center font-bold ${
                          v === 4 ? 'bg-emerald-500/30 text-emerald-400' :
                          v === 3 ? 'bg-cyan-500/30 text-cyan-400' :
                          v === 2 ? 'bg-amber-500/30 text-amber-400' :
                          v === 1 ? 'bg-orange-500/30 text-orange-400' :
                          'bg-red-500/30 text-red-400'
                        }`}>{v}</td>
                      ))}
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
            <div className="flex gap-4 mt-4 text-xs">
              <span className="flex items-center gap-2"><span className="w-3 h-3 rounded bg-emerald-500"></span> N4: Preferente</span>
              <span className="flex items-center gap-2"><span className="w-3 h-3 rounded bg-cyan-500"></span> N3: Estándar</span>
              <span className="flex items-center gap-2"><span className="w-3 h-3 rounded bg-amber-500"></span> N2: Condiciones</span>
              <span className="flex items-center gap-2"><span className="w-3 h-3 rounded bg-orange-500"></span> N1: Alto riesgo</span>
              <span className="flex items-center gap-2"><span className="w-3 h-3 rounded bg-red-500"></span> N0: Crítico</span>
            </div>
          </div>
        </div>
      );
    }

    // ============================================
    // DATA LAYER
    // ============================================
    function DataLayer() {
      return (
        <div className="space-y-8">
          <SectionHeader title="Modelo de Datos" subtitle="Entidades principales del sistema" />

          {/* Entities */}
          <div className="bg-slate-900/50 rounded-2xl border border-slate-800 p-8">
            <div className="grid grid-cols-3 gap-6">
              <EntityCard title="PERSONA" color="cyan" fields={['persona_id (PK)', 'rut', 'tipo', 'estado', 'canal_origen']} />
              <EntityCard title="ACTIVO" color="emerald" fields={['activo_id (PK)', 'direccion', 'comuna', 'tipologia', 'valor_uf']} />
              <EntityCard title="OPERACION" color="amber" fields={['operacion_id (PK)', 'persona_id (FK)', 'activo_id (FK)', 'producto_tipo', 'monto_uf']} />
            </div>
            <div className="grid grid-cols-4 gap-4 mt-6">
              <MiniEntity title="CUOTA" fields={['cuota_id', 'fecha_venc', 'monto_uf', 'estado', 'dias_mora']} />
              <MiniEntity title="EVALUACION" fields={['eval_id', 'scoring', 'decision', 'nivel']} />
              <MiniEntity title="PERFIL_FINANCIERO" fields={['renta_bruta', 'carga_financiera', 'score_cmf']} />
              <MiniEntity title="RBI_SCORE" fields={['score', 'consistency', 'timing', 'fecha']} highlight />
            </div>
          </div>

          {/* Data Sources */}
          <div className="grid grid-cols-2 gap-6">
            <div className="bg-slate-900/50 rounded-xl border border-slate-800 p-6">
              <h3 className="text-lg font-semibold text-cyan-400 mb-4">Fuentes Internas</h3>
              <div className="space-y-2">
                {[
                  { name: 'FIDES Behavioral', freq: 'Real-time', status: 'priority' },
                  { name: 'HubSpot CRM', freq: 'Real-time', status: 'active' },
                  { name: 'Portal pagos', freq: 'Diario', status: 'active' },
                  { name: 'Motor Excel (legacy)', freq: 'Manual', status: 'migrar' },
                ].map((s) => (
                  <div key={s.name} className="flex items-center justify-between py-2 border-b border-slate-800">
                    <span className="text-slate-300 text-sm">{s.name}</span>
                    <div className="flex items-center gap-2">
                      <span className="text-slate-500 text-xs">{s.freq}</span>
                      <StatusBadge status={s.status} />
                    </div>
                  </div>
                ))}
              </div>
            </div>
            <div className="bg-slate-900/50 rounded-xl border border-slate-800 p-6">
              <h3 className="text-lg font-semibold text-emerald-400 mb-4">Fuentes Externas</h3>
              <div className="space-y-2">
                {[
                  { name: 'Sinacofi', freq: 'Por consulta', status: 'active' },
                  { name: 'CMF', freq: 'Mensual', status: 'active' },
                  { name: 'SII', freq: 'Por consulta', status: 'active' },
                  { name: 'Gig APIs', freq: 'Por consulta', status: 'planned' },
                  { name: 'Open Banking', freq: 'Real-time', status: 'planned' },
                ].map((s) => (
                  <div key={s.name} className="flex items-center justify-between py-2 border-b border-slate-800">
                    <span className="text-slate-300 text-sm">{s.name}</span>
                    <div className="flex items-center gap-2">
                      <span className="text-slate-500 text-xs">{s.freq}</span>
                      <StatusBadge status={s.status} />
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    }

    // ============================================
    // OPERATIONS LAYER
    // ============================================
    function OperationsLayer() {
      return (
        <div className="space-y-8">
          <SectionHeader title="Máquinas de Estado" subtitle="Ciclo de vida — compartidas entre productos" />

          <div className="space-y-6">
            <StateMachine
              title="M1: Persona"
              color="cyan"
              shared
              states={['LEAD', 'PROSPECTO', 'PRE_APROBADO', 'CLIENTE_ACTIVO', 'MULTI_PRODUCTO', 'ESCRITURADO']}
              terminals={['DESISTIDO', 'RECHAZADO', 'DEFAULT']}
            />
            <StateMachine
              title="M3: Operación"
              color="amber"
              shared
              states={['SIMULADA', 'APROBADA', 'ACTIVA', 'EN_AHORRO', 'EN_ESCRITURACION', 'FINALIZADA']}
              terminals={['DESISTIDA', 'RECHAZADA', 'DEFAULT']}
            />
            <StateMachine
              title="M4: Cuota"
              color="rose"
              shared
              states={['PROGRAMADA', 'VIGENTE', 'PAGADA', 'MORA_TEMPRANA', 'MORA_MEDIA', 'MORA_GRAVE']}
              terminals={['CASTIGADA', 'CONDONADA']}
            />
            <StateMachine
              title="M5: Escrituración (R2O)"
              color="violet"
              states={['ELEGIBLE', 'VALIDACION', 'ENVIADO_BANCO', 'APROBADO_BANCO', 'AGENDADO', 'ESCRITURADO']}
              terminals={['RECHAZADO_BANCO', 'NO_CALIFICA']}
            />
          </div>
        </div>
      );
    }

    // ============================================
    // ROADMAP LAYER
    // ============================================
    function RoadmapLayer({ activePhase, setActivePhase }) {
      const phases = [
        { n: 1, name: 'Fundación', q: 'Q1 2025', budget: '$43M', items: ['Data Layer', 'Risk Engine API', 'FIDES MVP', 'Dashboard'] },
        { n: 2, name: 'Core Ops', q: 'Q2 2025', budget: '$50M', items: ['Originación digital', 'Cobranza', 'RBI Score v1', 'Comités'] },
        { n: 3, name: 'Inteligencia', q: 'Q3 2025', budget: '$60M', items: ['AI Underwriting', 'Identity Graph', 'Rent Reporting', 'Collection Agent'] },
        { n: 4, name: 'Escala', q: 'Q4 2025', budget: '$60M', items: ['Multi-Producto', 'Crédito Consumo', 'Open Banking', 'FIDES v2'] },
      ];

      const current = phases[activePhase - 1];

      return (
        <div className="space-y-8">
          <SectionHeader title="Roadmap 2025" subtitle="Hacia plataforma multi-producto" />

          {/* Timeline */}
          <div className="relative">
            <div className="absolute top-6 left-0 right-0 h-1 bg-slate-800 rounded-full"></div>
            <div className="relative grid grid-cols-4 gap-4">
              {phases.map((p) => (
                <div
                  key={p.n}
                  onClick={() => setActivePhase(p.n)}
                  className={`relative pt-10 cursor-pointer transition-all ${activePhase === p.n ? 'scale-105' : 'opacity-70 hover:opacity-100'}`}
                >
                  <div className={`absolute top-4 left-1/2 -translate-x-1/2 w-4 h-4 rounded-full border-2 ${
                    activePhase === p.n ? 'bg-cyan-500 border-cyan-400' : 'bg-slate-700 border-slate-600'
                  }`}></div>
                  <div className={`rounded-xl border p-4 ${
                    activePhase === p.n ? 'bg-cyan-500/10 border-cyan-500/50' : 'bg-slate-900/50 border-slate-800'
                  }`}>
                    <div className="flex justify-between text-xs mb-2">
                      <span className={activePhase === p.n ? 'text-cyan-400' : 'text-slate-500'}>{p.q}</span>
                      <span className="text-slate-500">{p.budget}</span>
                    </div>
                    <h4 className={`font-bold ${activePhase === p.n ? 'text-cyan-400' : 'text-white'}`}>F{p.n}: {p.name}</h4>
                  </div>
                </div>
              ))}
            </div>
          </div>

          {/* Phase Detail */}
          <div className="bg-slate-900/50 rounded-xl border border-slate-800 p-6">
            <h3 className="text-xl font-bold text-white mb-4">
              Fase {current.n}: {current.name}
              <span className="text-slate-400 text-sm font-normal ml-2">{current.q}</span>
            </h3>
            <div className="grid grid-cols-2 gap-6">
              <div>
                <h4 className="text-sm text-slate-400 mb-2">Entregables</h4>
                <ul className="space-y-2">
                  {current.items.map((item) => (
                    <li key={item} className="flex items-center gap-2 text-slate-300">
                      <CheckCircle2 className="w-4 h-4 text-cyan-500" />{item}
                    </li>
                  ))}
                </ul>
              </div>
              <div>
                <h4 className="text-sm text-slate-400 mb-2">Presupuesto</h4>
                <p className="text-3xl font-bold text-cyan-400">{current.budget} CLP</p>
              </div>
            </div>
          </div>

          {/* Multi-Product Timeline */}
          <div className="bg-gradient-to-r from-violet-500/10 to-cyan-500/10 rounded-xl border border-violet-500/30 p-6">
            <h3 className="text-lg font-semibold text-white mb-4">Timeline Multi-Producto</h3>
            <div className="grid grid-cols-4 gap-4 text-center text-sm">
              <div>
                <p className="text-emerald-400 font-bold">2024-25</p>
                <p className="text-slate-400">Rent-to-Own</p>
                <p className="text-xs text-slate-500">Producto ancla</p>
              </div>
              <div>
                <p className="text-cyan-400 font-bold">Q4 2025</p>
                <p className="text-slate-400">Crédito Consumo</p>
                <p className="text-xs text-slate-500">Cross-sell</p>
              </div>
              <div>
                <p className="text-amber-400 font-bold">2026</p>
                <p className="text-slate-400">Adelantos + Mejoras</p>
                <p className="text-xs text-slate-500">Expansión</p>
              </div>
              <div>
                <p className="text-violet-400 font-bold">2026+</p>
                <p className="text-slate-400">Gig Finance</p>
                <p className="text-xs text-slate-500">FIDES puro</p>
              </div>
            </div>
          </div>

          {/* Total Investment */}
          <div className="bg-gradient-to-r from-cyan-500/10 to-blue-500/10 rounded-xl border border-cyan-500/30 p-6">
            <div className="flex justify-between items-center">
              <div>
                <h3 className="text-lg font-semibold text-white">Inversión Total 2025</h3>
                <p className="text-slate-400">4 fases de desarrollo</p>
              </div>
              <div className="text-right">
                <p className="text-3xl font-bold text-cyan-400">$213M CLP</p>
                <p className="text-slate-400">~$223K USD</p>
              </div>
            </div>
          </div>
        </div>
      );
    }

    // ============================================
    // HELPER COMPONENTS
    // ============================================

    function SectionHeader({ title, subtitle }) {
      return (
        <div className="mb-6">
          <h2 className="text-2xl font-bold text-white">{title}</h2>
          <p className="text-slate-400 mt-1">{subtitle}</p>
        </div>
      );
    }

    function ValuePropCard({ icon: Icon, title, desc, color }) {
      const colors = {
        violet: 'from-violet-500/10 to-violet-500/5 border-violet-500/30',
        cyan: 'from-cyan-500/10 to-cyan-500/5 border-cyan-500/30',
        emerald: 'from-emerald-500/10 to-emerald-500/5 border-emerald-500/30',
      };
      const textColors = { violet: 'text-violet-400', cyan: 'text-cyan-400', emerald: 'text-emerald-400' };

      return (
        <div className={`bg-gradient-to-br ${colors[color]} rounded-xl border p-6`}>
          <Icon className={`w-8 h-8 ${textColors[color]} mb-3`} />
          <h3 className={`text-lg font-bold ${textColors[color]}`}>{title}</h3>
          <p className="text-sm text-slate-400 mt-2">{desc}</p>
        </div>
      );
    }

    function ModuleChip({ icon: Icon, label, status, highlight }) {
      const statusStyles = {
        live: 'bg-emerald-500/20 border-emerald-500/40 text-emerald-400',
        dev: 'bg-amber-500/20 border-amber-500/40 text-amber-400',
        design: 'bg-blue-500/20 border-blue-500/40 text-blue-400',
        priority: 'bg-violet-500/20 border-violet-500/40 text-violet-400',
        planned: 'bg-slate-500/20 border-slate-500/40 text-slate-400',
        research: 'bg-blue-500/20 border-blue-500/40 text-blue-400',
      };

      return (
        <div className={`px-3 py-2 rounded-lg border flex items-center gap-2 ${highlight ? 'bg-violet-500/10 border-violet-500/30' : statusStyles[status]}`}>
          <Icon className="w-4 h-4" />
          <span className="text-xs font-medium">{label}</span>
        </div>
      );
    }

    function StatCard({ number, label, color }) {
      const colors = {
        cyan: 'from-cyan-500/20 to-cyan-500/5 border-cyan-500/30 text-cyan-400',
        emerald: 'from-emerald-500/20 to-emerald-500/5 border-emerald-500/30 text-emerald-400',
        amber: 'from-amber-500/20 to-amber-500/5 border-amber-500/30 text-amber-400',
        rose: 'from-rose-500/20 to-rose-500/5 border-rose-500/30 text-rose-400',
        violet: 'from-violet-500/20 to-violet-500/5 border-violet-500/30 text-violet-400',
      };

      return (
        <div className={`bg-gradient-to-br ${colors[color]} rounded-xl border p-4 text-center`}>
          <p className="text-2xl font-bold">{number}</p>
          <p className="text-xs text-slate-400 mt-1">{label}</p>
        </div>
      );
    }

    function StatusBadge({ status, large }) {
      const styles = {
        live: 'bg-emerald-500/20 text-emerald-400',
        dev: 'bg-amber-500/20 text-amber-400',
        development: 'bg-amber-500/20 text-amber-400',
        priority: 'bg-violet-500/20 text-violet-400',
        planned: 'bg-slate-500/20 text-slate-400',
        research: 'bg-blue-500/20 text-blue-400',
        active: 'bg-emerald-500/20 text-emerald-400',
        migrar: 'bg-orange-500/20 text-orange-400',
      };
      const labels = {
        live: 'LIVE', dev: 'DEV', development: 'DEV', priority: 'PRIORITY',
        planned: 'PLANNED', research: 'RESEARCH', active: 'ACTIVO', migrar: 'MIGRAR'
      };

      return (
        <span className={`px-2 py-0.5 rounded text-xs ${styles[status]} ${large ? 'px-3 py-1' : ''}`}>
          {labels[status]}
        </span>
      );
    }

    function FidesCard({ icon: Icon, title, status, desc, items }) {
      return (
        <div className="bg-slate-800/50 rounded-xl border border-violet-500/20 p-5">
          <div className="flex items-start justify-between mb-3">
            <div className="flex items-center gap-3">
              <div className="w-10 h-10 bg-violet-500/20 rounded-lg flex items-center justify-center">
                <Icon className="w-5 h-5 text-violet-400" />
              </div>
              <div>
                <h4 className="font-semibold text-white">{title}</h4>
                <p className="text-xs text-slate-400">{desc}</p>
              </div>
            </div>
            <StatusBadge status={status} />
          </div>
          <div className="space-y-1.5 mt-4">
            {items.map((item, i) => (
              <div key={i} className="flex items-start gap-2 text-sm">
                <CheckCircle2 className="w-3.5 h-3.5 text-violet-400 mt-0.5 flex-shrink-0" />
                <span className="text-slate-300">{item}</span>
              </div>
            ))}
          </div>
        </div>
      );
    }

    function ScoreRow({ name, used, highlight }) {
      return (
        <div className={`flex items-center justify-between py-1.5 ${highlight ? 'text-violet-400' : ''}`}>
          <span className={`text-sm ${highlight ? 'text-violet-300' : 'text-slate-300'}`}>
            {name} {highlight && <Sparkles className="w-3 h-3 inline ml-1" />}
          </span>
          {used ? <CheckCircle2 className={`w-4 h-4 ${highlight ? 'text-violet-400' : 'text-emerald-400'}`} />
            : <span className="w-4 h-4 rounded-full border border-slate-600"></span>}
        </div>
      );
    }

    function ScoringCard({ title, range, usage, components, color, highlight }) {
      const colors = {
        cyan: 'border-cyan-500/30 bg-cyan-500/5',
        emerald: 'border-emerald-500/30 bg-emerald-500/5',
        violet: 'border-violet-500/30 bg-violet-500/5',
      };
      const textColors = { cyan: 'text-cyan-400', emerald: 'text-emerald-400', violet: 'text-violet-400' };

      return (
        <div className={`rounded-lg border ${colors[color]} p-4 ${highlight ? 'ring-2 ring-violet-500/50' : ''}`}>
          <div className="flex items-start justify-between mb-3">
            <div>
              <h4 className={`font-semibold ${textColors[color]}`}>{title}</h4>
              <p className="text-xs text-slate-500">{usage}</p>
            </div>
            <span className="text-xs text-slate-500">{range}</span>
          </div>
          <div className="space-y-2">
            {components.map((c) => (
              <div key={c.name} className="flex justify-between text-sm">
                <span className="text-slate-300">{c.name}</span>
                <span className="text-slate-500">{c.weight}</span>
              </div>
            ))}
          </div>
          {highlight && (
            <div className="mt-3 pt-3 border-t border-violet-500/30">
              <p className="text-xs text-violet-400 flex items-center gap-1">
                <Sparkles className="w-3 h-3" /> Diferenciador FIDES
              </p>
            </div>
          )}
        </div>
      );
    }

    function EntityCard({ title, color, fields }) {
      const colors = { cyan: 'border-cyan-500/50 bg-cyan-500/5', emerald: 'border-emerald-500/50 bg-emerald-500/5', amber: 'border-amber-500/50 bg-amber-500/5' };
      const textColors = { cyan: 'text-cyan-400', emerald: 'text-emerald-400', amber: 'text-amber-400' };

      return (
        <div className={`rounded-lg border ${colors[color]} p-4`}>
          <h4 className={`font-bold ${textColors[color]} mb-3`}>{title}</h4>
          <div className="space-y-1 text-xs">
            {fields.map((f) => <div key={f} className="text-slate-300">{f}</div>)}
          </div>
        </div>
      );
    }

    function MiniEntity({ title, fields, highlight }) {
      return (
        <div className={`rounded-lg border p-3 bg-slate-800/50 ${highlight ? 'border-violet-500/30' : 'border-slate-700'}`}>
          <h5 className={`font-semibold text-sm mb-2 ${highlight ? 'text-violet-400' : 'text-white'}`}>{title}</h5>
          <div className="text-[10px] text-slate-400 space-y-0.5">
            {fields.map((f) => <div key={f}>{f}</div>)}
          </div>
        </div>
      );
    }

    function StateMachine({ title, color, states, terminals, shared }) {
      const colors = { cyan: 'border-cyan-500/30', amber: 'border-amber-500/30', rose: 'border-rose-500/30', violet: 'border-violet-500/30' };
      const textColors = { cyan: 'text-cyan-400', amber: 'text-amber-400', rose: 'text-rose-400', violet: 'text-violet-400' };

      return (
        <div className={`bg-slate-900/50 rounded-xl border ${colors[color]} p-5`}>
          <div className="flex items-center justify-between mb-4">
            <h3 className={`font-bold ${textColors[color]}`}>{title}</h3>
            {shared !== undefined && (
              <span className={`px-2 py-0.5 rounded text-xs ${shared ? 'bg-emerald-500/20 text-emerald-400' : 'bg-amber-500/20 text-amber-400'}`}>
                {shared ? 'Compartido' : 'Específico'}
              </span>
            )}
          </div>
          <div className="flex items-center gap-2 flex-wrap">
            {states.map((s, i) => (
              <React.Fragment key={s}>
                <span className="px-3 py-1.5 bg-slate-800 rounded-lg border border-slate-700 text-sm text-white">{s}</span>
                {i < states.length - 1 && <ArrowRight className="w-4 h-4 text-slate-600 flex-shrink-0" />}
              </React.Fragment>
            ))}
          </div>
          <div className="mt-3 flex gap-2">
            <span className="text-xs text-slate-500">Terminales:</span>
            {terminals.map((t) => (
              <span key={t} className="px-2 py-0.5 bg-red-500/20 text-red-400 rounded text-xs">{t}</span>
            ))}
          </div>
        </div>
      );
    }

    // Render
    ReactDOM.render(<PropioOSBlueprint />, document.getElementById('root'));
  </script>
</body>
</html>
